\title{CS 383 - Machine Learning}
\author{
        Assignment 8 - Artificial Neural Networks\\
        Winter 2017
}
\date{}
\documentclass[12pt]{article}
\usepackage[margin=0.7in]{geometry}
\usepackage{graphicx}
\usepackage{float}
\usepackage{amsmath}

\begin{document}
\maketitle


\section*{Introduction}
In this assignment we'll implement non-linear classifier, an Artificial Neural Network, and look at using it for binary classification, varying precision and recall, and direct multi-class classification.  


\section*{Grading}
\begin{table}[h]
\begin{center}
\begin{tabular}{|l|l|}
\hline
Part 1 (Binary ANN) & 30pts\\
Part 2 (Precision-Recall) & 15pts\\
Part 3 (Multi-class ANN) & 15pts\\
Report & 5pts\\
\hline
\textbf{TOTAL} & 65pts\\
\hline
\end{tabular}
\end{center}
\end{table}

\newpage
\section*{Datasets}
\paragraph{Spambase Dataset  (spambase.data)}
This dataset consists of 4601 instances of data, each with 57 features and a class label designating if the sample is spam or not.
The features are \emph{real valued} and are described in much detail here:
\begin{center}
  https://archive.ics.uci.edu/ml/machine-learning-databases/spambase/spambase.names\\
\end{center}

\noindent
Data obtained from:  https://archive.ics.uci.edu/ml/datasets/Spambase

\subsubsection*{Cardiotocography Dataset  (CTG.csv)}

Download the file CTG.csv from Bblearn. This file contains 2126 instances of 21 feature pertaining to information obtained from Cardiotocography tests. Our task is to determine the fetal state class code given an observation. This code can be one of the 3 values and pertains to the LAST column of the dataset. The second to last column of the dataset can also be used for classification but for our purposes DISCARD it.\\

\noindent
Your scripts that use this dataset must be able to run on any dataset where the first two rows contain header information, the 2nd to last column is to be discarded, and the last column contains the target class.

\noindent
You can read more about the dataset here:
\begin{center}
http://archive.ics.uci.edu/ml/datasets/Cardiotocography
\end{center}

\newpage
\section{Artificial Neural Networks}
First download the dataset \emph{spambase.data} from Blackboard.  As mentioned in the Datasets area, this dataset contains 4601 rows of data, each with 57 continuous valued features followed by a binary class label (0=not-spam, 1=spam).  There is no header information in this file and the data is comma separated.  As always, your code should work on any dataset that lacks header information and has several comma-separated continuous-valued features followed by a class id $\in {0,1}$.\\

\noindent
You are to create, train, and test an artificial neural network containing a single hidden layer.  You are to do this \emph{from scratch}, not using any ANN library functions.

\noindent
\paragraph{Write a script that:}
\begin{enumerate}
  \item Reads in the data.
  \item Randomizes the data.
  \item Selects the first 2/3 (round up) of the data for training and the remaining for testing
  \item Standardizes the data (except for the last column of course as well as the bias feature) using the training data
  \item Trains an artificial neural network using the training data
  \item During the training process, compute the \emph{training error} after each iteration.  You will use this to plot the training error vs. iteration number.
  \item Classifies the testing data using the trained neural network.
  \item Computes the testing error.
\end{enumerate}


\paragraph{Implementation Details}
\begin{enumerate}
\item Seed the random number generate with zero prior to randomizing the data
\item Make sure to add a bias input node.
\item Set the learning parameter $\alpha=0.5$.
\item There should only be a single hidden layer.
\item The hidden layer size should be 20, although this should be a variable parameter.
\item Do \emph{batch} gradient descent.
\item Initialize all weights to random values in the range $[-1,1]$.
\item Do 1000 training iterations.
\item Since this is binary classification, you should only have one output node.
\item Consider a sample to be positive (Spam) if the output node has a value $>0.50$ and negative (Not Spam) otherwise.
\item Compute the testing error as $TestError=1-\frac{\#test samples correct}{total number of test samples}$.
\end{enumerate}


\paragraph{In your report you will need:}
\begin{enumerate}
\item The test error
\item A plot of \emph{training} error vs iteration.
\end{enumerate}

\begin{table}[h]
\begin{center}
\begin{tabular}{|l|l|}
\hline
Testing Error & 0.0841\\
\hline
\end{tabular}
\caption{ANN Testing Error}
\end{center}
\end{table}


\begin{figure}[H]
\begin{center}
\includegraphics{ANNTrainingError.png}
\caption{Training Error for ANN}
\end{center}
\end{figure}

\newpage

\section{The Precision-Recall Tradeoff}\label{naive}
Next we want to look at the precision-recall tradeoff by varying the threshold required to make an observation be considered spam.\\
\noindent

In the previous part your ANN classifier should have output a \emph{likelihood} of being Spam and if that likelihood is greater that 50\% we said that the observation is predicted to be spam.\\
\noindent

Now let's vary that threshold $t$ (which was previously 0.5) from 0.0 to 1.0 in increments of 0.1, each time computing the precision and recall by labeling observations as \emph{Positive} if their likelihood is greater that the current $t$ and \emph{Negative} otherwise.\\
\noindent

Finally we'll graph these $(precision, recall)$ pairs to form a Precision-Recall graph.

\paragraph{Implementation Details}
The same as in the prior problem.

\paragraph{In your report you will need:}
\begin{enumerate}
\item Your plot of precision vs recall on the testing set.
\end{enumerate}

\begin{figure}[H]
\begin{center}
\includegraphics{ANN_PR.png}
\caption{PR-Graph for ANN}
\end{center}
\end{figure}

\section{Multi-Class Artificial Neural Networks}
Download the \emph{CTG.csv} data set from Blackboard.  Your task is to determine the fetal state class code given an observation.  This code can be one of three values (multi-class!) and pertains to the \emph{last} column of the dataset.  The second to last column of the dataset can also be used for classification, but for our purposes \emph{discard it}.\\

\noindent
You are to create, train, and test an artificial neural network containing a single hidden layer.  You are to do this \emph{from scratch}, not using any ANN library functions.

\paragraph{Implementation Details}
Same as the other parts except...
\begin{enumerate}
\item Since there are three possible classes, we'll do multi-class classification directly by having an output layer have three nodes.  But this also should be a variable size based on the number of potential output values.   To choose the class label find the output node with the largest value.
\end{enumerate}


\paragraph{In your report you will need:}
\begin{enumerate}
\item The test error
\item A plot of \emph{training} error vs iteration.
\end{enumerate}


\begin{table}[h]
\begin{center}
\begin{tabular}{|l|l|}
\hline
Testing Error & 0.1142\\
\hline
\end{tabular}
\caption{ANN Testing Error}
\end{center}
\end{table}


\begin{figure}[H]
\begin{center}
\includegraphics{Multi_ANN_TE.png}
\caption{Training Error for Multi-Class ANN}
\end{center}
\end{figure}


\newpage
\section*{Submission}
For your submission, upload to Blackboard a single zip file containing:

\begin{enumerate}
\item PDF Writeup
\item Source Code
\item readme.txt file
\end{enumerate}

\noindent
The readme.txt file should contain information on how to run your code to reproduce results for each part of the assignment.\\

\noindent
The PDF document should contain the following:

\begin{enumerate}
\item Part 1:
	\begin{enumerate}
		\item Requested Statistical Information
		\item Plot of training error vs iteration.
	\end{enumerate}
\item Part 2:
	\begin{enumerate}
		\item Precision-Recall plot.
	\end{enumerate}
\item Part 3:
	\begin{enumerate}
		\item Requested Statistical Information
		\item Plot of training error vs iteration.
	\end{enumerate}
\end{enumerate}
\end{document}

